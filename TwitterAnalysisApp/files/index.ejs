<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Welcome!</title>
    <link rel="stylesheet" href="/cssFiles/style.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="/Script/script.js"></script>
</head>
<body> 
    <div class = "container">
        <br/>
        <div>
            <div id="content">
                <button type="button" class="btn btn-success" data-toggle="collapse" data-target="#map1">
                    Coordinates
                </button>
            </div>

            <div id="map1" class="collapse in">
                <div align="center" class="span4">
                    <div id="map-canvas"></div>
                    <br/>
                </div>
            </div>

            <div id="content">
                <button type="button" class="btn btn-warning" data-toggle="collapse" data-target="#map2">
                    Emotion
                </button>
            </div>
            
            <div id="map2" class="collapse in">
                <div align="center" class="span4">
                    <div id="map-canvas1"></div>
                    <br/>
                </div>
            </div>
            <!-- <div id="content">
                <button type="button" class="btn btn-info" data-toggle="collapse" data-target="#map3">
                    Sports
                </button>
            </div>

            <div id="map3" class="collapse in">
                <div align="center" class="span4">
                    <div id="map-canvas2"></div>
                    <br/>
                </div>
            </div> -->

            <!-- <script src="https://maps.googleapis.com/maps/api/js?libraries=visualization"></script> -->
            <!-- <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?libraries=visualization"></script>
            <script src="/Script/List.js"></script>
            <script src="/Script/Mapster.js"></script>
            <script src="/Script/map-options.js"></script> -->
            <script>
                var mel_coordinate = [];
                <% emlbourne_ans.forEach(function(tweets){ %>
                    var coor = [<%= tweets.value.coordinates.coordinates %>, "<%= tweets.value.lang %>"];
                    // console.log(coor);
                    mel_coordinate.push(coor);
                <% }); %>
                
            </script>
    
            <script>
                // (function(window, google, mapster) {
                //   var options = mapster.MAP_OPTIONS,
                // //   element = document.getElementById('map-canvas');
                // //   map = mapster.create(element, options);

                //   element1 = document.getElementById('map-canvas1'),
                //   map1 = mapster.create(element1, options);

                // //   // element2 = document.getElementById('map-canvas2'),
                // //   // map2 = mapster.create(element2, options);
                  
                // //   // var coor = heatmapData;
                // //   // console.log(coor);
                // //   mel_coordinate.forEach(function(coordinate){
                // //     map.addMarker({
                // //       lat: Number(coordinate[1]),
                // //       lng: Number(coordinate[0]),
                // //       draggable: false,
                // //     });
                
                // //   });  
                // }(window, google, window.Mapster || (window.Mapster = {})));
                  var map, heatmap;

                  function initMap() {
                    map = new google.maps.Map(document.getElementById('map-canvas'), {
                      zoom: 9,
                      center: {lat: -37.96, lng: 145},
                      mapTypeId: 'hybrid'
                    });

                    map1 = new google.maps.Map(document.getElementById('map-canvas1'), {
                      zoom: 9,
                      center: {lat: -37.96, lng: 145},
                      mapTypeId: 'hybrid'
                    });

                    heatmap = new google.maps.visualization.HeatmapLayer({
                      data: getPoints(),
                      map: map, 
                      radius: 50
                    });
                  }

                  function getPoints() {

                        var heatmapData = [];
                        mel_coordinate.forEach(function(element){
                            
                            var weight;
                            if (element[2] === "es") {
                                weight = 300000;
                            } else if (element[2] === "in"){
                                weight = 1;
                            } else if (element[2] === "ja"){
                                weight = 1;
                            } else if (element[2] === "und"){
                                weight = 1;
                            } else {
                                weight = 1;
                            }

                            var coor_object = {
                                "location": new google.maps.LatLng(Number(element[1]), Number(element[0])),
                                "weight": weight
                            };
                            heatmapData.push(coor_object);
                        });
                        console.log(heatmapData);
                        return heatmapData;
                }
            </script>
            <!-- <script async defer
                src="https://maps.googleapis.com/maps/api/js?&libraries=visualization&callback=initMap">
            </script> -->
            <script async defer string APIkey = "AIzaSyBQBLox4iZGLk4CjpHtJf1FgxyNY0e8jX0"; src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBQBLox4iZGLk4CjpHtJf1FgxyNY0e8jX0&libraries=visualization&callback=initMap"></script>
        </div>
    </div>
</div>
    
</body>
</html>